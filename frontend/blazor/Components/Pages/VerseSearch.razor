@page "/verse-search"
@using PalavraConectada.Blazor.Services
@inject BackendApiService BackendApi
@inject NavigationManager Navigation

<!-- Componente de busca inteligente - Blazor com IA! -->
<PageTitle>Palavra Conectada üìñ</PageTitle>

<div class="verse-search-container">
    <!-- HEADER -->
    <div class="header">
        <h1>üìñ Palavra Conectada</h1>
        <p class="subtitle">
            @(searchMode == "intelligent" 
                ? "Conte como voc√™ est√° se sentindo e receba vers√≠culos personalizados com IA" 
                : "Busque vers√≠culos por palavra-chave")
        </p>
    </div>

    <!-- TOGGLE DE MODO -->
    <div class="mode-toggle">
        <button 
            @onclick='() => searchMode = "intelligent"' 
            class='@($"mode-btn {(searchMode == "intelligent" ? "active" : "")}")'
        >
            üß† Busca Inteligente (IA)
        </button>
        <button 
            @onclick='() => searchMode = "simple"' 
            class='@($"mode-btn {(searchMode == "simple" ? "active" : "")}")'
        >
            üîç Busca Simples
        </button>
    </div>

    <!-- √ÅREA DE BUSCA -->
    <div class="search-section">
        <div class="search-box">
            <input 
                type="text" 
                @bind="searchTerm" 
                @bind:event="oninput"
                @onkeyup="HandleKeyPress"
                placeholder='@(searchMode == "intelligent" 
                    ? "Ex: Estou triste, Estou com medo, Estou ansioso..." 
                    : "Ex: amor, paz, esperan√ßa...")'
                class="search-input"
            />
            
            <select @bind="selectedVersion" class="version-select">
                @foreach (var version in availableVersions)
                {
                    <option value="@version.Code">@version.Name</option>
                }
            </select>
        </div>

        <div class="button-group">
            <button @onclick="Search" disabled="@isLoading" class="btn btn-primary">
                @(isLoading ? "Processando..." : (searchMode == "intelligent" ? "üß† Analisar com IA" : "üîç Buscar"))
            </button>
            
            <button @onclick="GetRandomVerse" disabled="@isLoading" class="btn btn-secondary">
                üé≤ Surpreenda-me
            </button>
        </div>
    </div>

    <!-- EXEMPLOS DE BUSCA -->
    @if (intelligentResult == null && searchResult == null && randomVerse == null && !isLoading)
    {
        <div class="examples-section">
            <p class="examples-title">‚ú® Experimente:</p>
            <div class="examples-grid">
                @foreach (var example in exampleSearches)
                {
                    <button 
                        @onclick="() => UseExample(example.Term, example.Mode)"
                        class='@($"example-btn {(example.Mode == "intelligent" ? "intelligent" : "")}")'
                        disabled="@isLoading">
                        <span class="example-term">@example.Term</span>
                        <span class="example-desc">@example.Description</span>
                    </button>
                }
            </div>
        </div>
    }

    <!-- MENSAGEM DE ERRO -->
    @if (!string.IsNullOrEmpty(errorMessage))
    {
        <div class="alert alert-error">
            ‚ö†Ô∏è @errorMessage
        </div>
    }

    <!-- LOADING -->
    @if (isLoading)
    {
        <div class="loading">
            <div class="spinner"></div>
            <p>@(searchMode == "intelligent" ? "Analisando suas emo√ß√µes..." : "Buscando na Palavra de Deus...")</p>
        </div>
    }

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- RESULTADO INTELIGENTE (COM IA) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    @if (intelligentResult != null)
    {
        <div class="intelligent-results">
            
            <!-- AN√ÅLISE DE EMO√á√ÉO -->
            <div class="emotion-analysis">
                <div class="emotion-header">
                    <span class="emotion-icon">@GetEmotionIcon(intelligentResult.DetectedEmotion)</span>
                    <div>
                        <h3>@intelligentResult.Message</h3>
                        <div class="emotion-meta">
                            <span class="emotion-name">@intelligentResult.DetectedEmotion</span>
                            <span class='@($"badge {GetConfidenceBadgeClass(intelligentResult.Confidence)}")'>
                                @intelligentResult.Confidence% de confian√ßa
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VERS√çCULO RECOMENDADO -->
            @if (intelligentResult.RecommendedVerse != null)
            {
                <div class="recommended-verse">
                    <div class="verse-label">
                        <span class="star">‚≠ê</span> 
                        <strong>Vers√≠culo Recomendado para Voc√™:</strong>
                    </div>
                    
                    <div class="verse-card featured">
                        <div class="verse-reference">
                            @GetVerseReference(intelligentResult.RecommendedVerse)
                        </div>
                        <div class="verse-text">
                            "@intelligentResult.RecommendedVerse.Text"
                        </div>
                        <div class="verse-footer">
                            <span class="verse-meta">
                                @intelligentResult.RecommendedVerse.Author ‚Ä¢ 
                                @intelligentResult.RecommendedVerse.Testament
                            </span>
                        </div>
                    </div>
                </div>
            }

            <!-- VERS√çCULOS ALTERNATIVOS -->
            @if (intelligentResult.AlternativeVerses?.Any() == true)
            {
                <div class="alternative-verses">
                    <h4>üìö Outros vers√≠culos que podem ajudar:</h4>
                    <div class="verses-grid">
                        @foreach (var verse in intelligentResult.AlternativeVerses)
                        {
                            <div class="verse-card">
                                <div class="verse-reference-small">
                                    @GetVerseReference(verse)
                                </div>
                                <div class="verse-text-small">
                                    "@verse.Text"
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }

            <!-- SUGEST√ïES -->
            @if (intelligentResult.Suggestions?.Any() == true)
            {
                <div class="suggestions">
                    <h4>üí° O que voc√™ pode fazer:</h4>
                    <ul class="suggestions-list">
                        @foreach (var suggestion in intelligentResult.Suggestions)
                        {
                            <li>@suggestion</li>
                        }
                    </ul>
                </div>
            }

        </div>
    }

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- RESULTADO SIMPLES (BUSCA POR PALAVRA) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    @if (searchResult != null && searchResult.Count > 0)
    {
        <div class="results-section">
            <div class="results-header">
                <h2>üìö Resultados da Busca</h2>
                <p class="results-count">
                    Encontrados <strong>@searchResult.Count</strong> 
                    vers√≠culo(s) com "<strong>@searchResult.Keyword</strong>"
                </p>
            </div>

            <div class="verses-container">
                @foreach (var verse in searchResult.Verses)
                {
                    <div class="verse-card">
                        <div class="verse-reference">
                            @GetVerseReference(verse)
                        </div>
                        
                        <div class="verse-text">
                            "@verse.Text"
                        </div>
                        
                        <div class="verse-footer">
                            <span class="verse-meta">
                                @verse.Author ‚Ä¢ @verse.Group
                            </span>
                        </div>
                    </div>
                }
            </div>
        </div>
    }

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- VERS√çCULO ALEAT√ìRIO -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    @if (randomVerse != null)
    {
        <div class="random-verse">
            <div class="verse-label">
                <span class="dice">üé≤</span> 
                <strong>Vers√≠culo do Dia:</strong>
            </div>
            
            <div class="verse-card featured">
                <div class="verse-reference">
                    @GetVerseReference(randomVerse)
                </div>
                <div class="verse-text">
                    "@randomVerse.Text"
                </div>
                <div class="verse-footer">
                    <span class="verse-meta">
                        @randomVerse.Author ‚Ä¢ @randomVerse.Group
                    </span>
                </div>
            </div>
        </div>
    }

    <!-- FOOTER -->
    <div class="footer">
        <p>Desenvolvido com üíô usando Blazor + ASP.NET Core + IA</p>
        <p class="tech-stack">Blazor WebAssembly | C# | SQLite | Entity Framework</p>
    </div>
</div>

@code {
    // Estado da aplica√ß√£o
    private string searchTerm = string.Empty;
    private string selectedVersion = "nvi";
    private string searchMode = "intelligent";
    
    // Resultados
    private SearchVerseResponse? searchResult;
    private RecommendationResponse? intelligentResult;
    private VerseDto? randomVerse;
    
    // UI State
    private bool isLoading = false;
    private string errorMessage = string.Empty;

    // Vers√µes dispon√≠veis da B√≠blia
    private List<BibleVersion> availableVersions = new()
    {
        new() { Code = "nvi", Name = "Nova Vers√£o Internacional" },
        new() { Code = "acf", Name = "Almeida Corrigida Fiel" },
        new() { Code = "aa", Name = "Almeida Revista e Atualizada" }
    };

    // Exemplos de buscas para ajudar o usu√°rio
    private List<ExampleSearch> exampleSearches = new()
    {
        new() { Term = "Estou triste hoje", Description = "IA detecta tristeza e recomenda consolo", Mode = "intelligent" },
        new() { Term = "Estou com medo", Description = "IA detecta medo e recomenda coragem", Mode = "intelligent" },
        new() { Term = "Estou ansioso", Description = "IA detecta ansiedade e recomenda paz", Mode = "intelligent" },
        new() { Term = "amor", Description = "Busca simples por palavra", Mode = "simple" },
        new() { Term = "paz", Description = "Busca simples por palavra", Mode = "simple" }
    };

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // BUSCA INTELIGENTE (COM IA)
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    private async Task IntelligentSearch()
    {
        if (string.IsNullOrWhiteSpace(searchTerm))
        {
            errorMessage = "Por favor, insira como voc√™ est√° se sentindo.";
            return;
        }

        isLoading = true;
        errorMessage = string.Empty;
        ClearResults();

        try
        {
            var result = await BackendApi.GetIntelligentRecommendationAsync(searchTerm, selectedVersion);
            intelligentResult = result;

            if (result?.RecommendedVerse == null)
            {
                errorMessage = "N√£o consegui encontrar vers√≠culos para este sentimento.";
            }
        }
        catch (Exception ex)
        {
            errorMessage = "Erro ao processar sua busca. Tente novamente.";
            Console.WriteLine($"Erro: {ex.Message}");
        }
        finally
        {
            isLoading = false;
        }
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // BUSCA SIMPLES (POR PALAVRA)
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    private async Task SimpleSearch()
    {
        if (string.IsNullOrWhiteSpace(searchTerm))
        {
            errorMessage = "Por favor, insira uma palavra para buscar.";
            return;
        }

        isLoading = true;
        errorMessage = string.Empty;
        ClearResults();

        try
        {
            var result = await BackendApi.SearchVersesAsync(searchTerm, selectedVersion);
            searchResult = result;

            if (result?.Count == 0)
            {
                errorMessage = "Nenhum vers√≠culo encontrado com esta palavra.";
            }
        }
        catch (Exception ex)
        {
            errorMessage = "Erro ao buscar vers√≠culos. Tente novamente.";
            Console.WriteLine($"Erro: {ex.Message}");
        }
        finally
        {
            isLoading = false;
        }
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // BUSCA ALEAT√ìRIA
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    private async Task GetRandomVerse()
    {
        isLoading = true;
        errorMessage = string.Empty;
        ClearResults();

        try
        {
            randomVerse = await BackendApi.GetRandomVerseAsync(selectedVersion);
        }
        catch (Exception ex)
        {
            errorMessage = "Erro ao buscar vers√≠culo. Tente novamente.";
            Console.WriteLine($"Erro: {ex.Message}");
        }
        finally
        {
            isLoading = false;
        }
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // M√âTODOS DE APOIO
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    private async Task Search()
    {
        if (searchMode == "intelligent")
        {
            await IntelligentSearch();
        }
        else
        {
            await SimpleSearch();
        }
    }

    private async Task UseExample(string term, string mode)
    {
        searchTerm = term;
        searchMode = mode;
        await Search();
    }

    private async Task HandleKeyPress(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            await Search();
        }
    }

    private void ClearResults()
    {
        searchResult = null;
        intelligentResult = null;
        randomVerse = null;
    }

    private string GetVerseReference(VerseDto verse)
    {
        return $"{verse.BookName} {verse.Chapter}:{verse.Number}";
    }

    private string GetConfidenceBadgeClass(int confidence)
    {
        if (confidence >= 80) return "badge-success";
        if (confidence >= 50) return "badge-warning";
        return "badge-secondary";
    }

    private string GetEmotionIcon(string emotion)
    {
        return emotion.ToLower() switch
        {
            "tristeza" => "üò¢",
            "alegria" => "üòä",
            "medo" => "üò®",
            "ansiedade" => "üò∞",
            "solid√£o" => "üòî",
            "raiva" => "üò†",
            "gratid√£o" => "üôè",
            "esperan√ßa" => "üåü",
            _ => "üí≠"
        };
    }

    // Classes auxiliares
    private class ExampleSearch
    {
        public string Term { get; set; } = string.Empty;
        public string Description { get; set; } = string.Empty;
        public string Mode { get; set; } = "simple";
    }

    private class BibleVersion
    {
        public string Code { get; set; } = string.Empty;
        public string Name { get; set; } = string.Empty;
    }
}
